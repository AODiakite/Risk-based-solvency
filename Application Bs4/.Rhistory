NB_contrat = Mat_tPx(mat_ages)
NB_contrat = apply(NB_contrat,1,cumprod)
View(NB_contrat)
NB_contrat = Mat_tPx(mat_ages)
NB_contrat = t(apply(NB_contrat,1,cumprod))
rep(1,0)
NB_contrat = Mat_tPx(mat_ages)
NB_contrat = t(apply(NB_contrat,1,cumprod))
Duree_contrat_rest
max_duree_rest = max(Duree_contrat_rest)
Map(\(x){
c(rep(1,x),rep(1,max_duree_rest-x))
}, x = Duree_contrat_rest)
Map(\(x){
c(rep(1,x),rep(0,max_duree_rest-x))
}, x = Duree_contrat_rest)
max_duree_rest = max(Duree_contrat_rest)
mat_duree = Map(\(x){
c(rep(1,x),rep(0,max_duree_rest-x))
}, x = Duree_contrat_rest)
mat_duree = as.data.frame(mat_duree)
View(mat_duree)
mat_duree = t(mat_duree)
rownames(mat_duree) = NULL
NB_contrat = NB_contrat*mat_duree
NB_contrat = apply(NB_contrat,2,sum)
NB_contrat
ZC
# Nombre de contrat
# Parametre FG_moyen
FG_moyen = 100
FG_t = FG_moyen*NB_contrat
14/100
1.5/100
FG_moyen = 100
Augmentation_X = 0.14
Majoration_X = 0.015
FG_t
## FG_t après choque
vect_choque_FG = 1+c(Augmentation_X,rep(Majoration_X,max_duree_rest-1))
FG_t_Choque = FG_moyen * vect_choque_FG
FG_t_Choque
## FG_t après choque
vect_choque_FG = 1+c(Augmentation_X,rep(Majoration_X,max_duree_rest-1))
FG_t_Choque = FG_moyen * cumprod(vect_choque_FG)
FG_t_Choque
FG_t
FG_t_Choque = FG_t_Choque * NB_contrat
FG_t_Choque
# BEFG
BEFG = \(FG_t,ZC){
n_max = length(FG_t)
denom = (1 + ZC[1:n_max])^(1:n_max)
sum(FG_t/denom)
}
BEFG(FG_t,ZC)
BEFG(FG_t_Choque,ZC)
proj_cap_vect = projection_cap(proj_cap)
proj_cap_vect
Mat_Proj_Cap <- function(Duree_contrat_rest,ages,choc = 0){
mat_ages = Mat_Ages(Duree_contrat_rest,ages)
mat_tqx =(1+choc) * Mat_tQx(mat_ages)
mat_tpx = 1 -  mat_tqx
mat_tpx = cbind(1,mat_tpx[,-ncol(mat_tpx)])
mat_tpx_cumul = t(apply(mat_tpx,1,cumprod))
# Matrice de projection des capitaux
mat_tqx*df_capitaux*mat_tpx_cumul
}
proj_cap = Mat_Proj_Cap(Duree_contrat_rest,ages,choc = 0)
proj_cap
proj_cap_choc_003 = Mat_Proj_Cap(Duree_contrat_rest,ages,choc = 0.03)
proj_cap_choc_002 = Mat_Proj_Cap(Duree_contrat_rest,ages,choc = 0.02)
proj_cap_vect_003 = projection_cap(proj_cap_choc_003)
proj_cap_vect_002 = projection_cap(proj_cap_choc_002)
proj_cap_choc_003
proj_cap_vect_003
BEGP_vie <- function(proj_cap_vect, ZC){
nn = length(proj_cap_vect)
denom = (1+ZC[1:nn])^(1:nn)
sum(proj_cap_vect/denom)
}
BEGP_vie(proj_cap_vect_003,ZC)
View((1+3/100)*mat_tqx)
View(mat_ages)
View(1-((1+3/100)*mat_tqx))
View(1-((1+30/100)*mat_tqx))
proj_cap = Mat_Proj_Cap(Duree_contrat_rest,ages,choc = 0)
proj_cap_choc_003 = Mat_Proj_Cap(Duree_contrat_rest,ages,choc = 0.3)
proj_cap_choc_002 = Mat_Proj_Cap(Duree_contrat_rest,ages,choc = 0.2)
projection_cap <- function(proj_cap){
apply(proj_cap,2,sum)
}
proj_cap_vect = projection_cap(proj_cap)
proj_cap_vect_003 = projection_cap(proj_cap_choc_003)
proj_cap_vect_002 = projection_cap(proj_cap_choc_002)
proj_cap_vect_003
BEGP_vie(proj_cap_vect_003,ZC)
BEGP_vie(proj_cap_vect_002,ZC)
BEGP = BEGP_vie(proj_cap_vect,ZC)
BEGP_Choc_003 = BEGP_vie(proj_cap_vect_003,ZC)
BEGP_Choc_002 = BEGP_vie(proj_cap_vect_002,ZC)
BGP
BEGP
BEGP_Choc_002
BEGP_Choc_002
BEFG(FG_t_Choque,ZC)
BEFG_vie = BEFG(FG_t,ZC)
BEFG_vie_Choque = BEFG(FG_t_Choque,ZC)
BEFG_vie_Choque
max(c(1,5,-6,8,4),0)
taux_cession = 1/100
PD = 1.2/100
BEGP
BEGP_Choc_002
proj_cap_vect
BEGPi = proj_cap_vect
BEGP_cede = BEGPi*taux_cession
Adj_i = Map(\(x,y){
0.5*max(x,0)*PD*(1-PD)^(y-1)
} x = BEGPi, y = 1:length(BEGPi))
Adj_i = Map(\(x,y){
0.5*max(x,0)*PD*(1-PD)^(y-1)
}, x = BEGPi, y = 1:length(BEGPi))
Adj_i
Adj_i = Map(\(x,y){
0.5*max(x,0)*PD*(1-PD)^(y-1)
}, x = as.list(BEGPi), y = as.list(1:length(BEGPi)))
Adj_i
PD
taux_cession
BEGP_cede = BEGPi*taux_cession
Adj_i = Map(\(x,y){
0.5*max(x,0)*PD*(1-PD)^(y-1)
}, x = as.list(BEGP_cede), y = as.list(1:length(BEGP_cede)))
Adj_i
BEGP_cede
taux_cession
1/100
BEGPi
proj_cap_vect
proj_cap
apply(proj_cap,3,sum)
apply(proj_cap,2,sum)
BEGP_cede = cumsum(rev(BEGPi))
BEGP_cede = rev(BEGP_cede)
BEGP_cede
BEGPi_actualised = BEGPi/((1+ZC[1:length(BEGPi)])^(1:length(BEGPi)))
BEGP_cede = cumsum(rev(BEGPi_actualised))
BEGP_cede = rev(BEGP_cede)
BEGP_cede
BEGP_cede = BEGPi*taux_cession
BEGPi_actualised = BEGPi/((1+ZC[1:length(BEGPi)])^(1:length(BEGPi)))
BEGP_cede = cumsum(rev(BEGPi_actualised))
BEGP_cede = rev(BEGP_cede)
BEGP_cede = BEGPi*taux_cession
Adj_i = Map(\(x,y){
0.5*max(x,0)*PD*(1-PD)^(y-1)
}, x = as.list(BEGP_cede), y = as.list(1:length(BEGP_cede)))
Adj_i = unlist(Adj_i)
Adj_i
BEGP_cede
BEGPi_actualised = BEGPi/((1+ZC[1:length(BEGPi)])^(1:length(BEGPi)))
BEGP_cede = cumsum(rev(BEGPi_actualised))
BEGP
BEGP_cede
BEGPi_actualised = BEGPi/((1+ZC[1:length(BEGPi)])^(1:length(BEGPi)))
BEGPi_actualised
BEGP_cede = cumsum(rev(BEGPi_actualised))
BEGP_cede
BEGP_cede = rev(BEGP_cede)
BEGP_cede
BEGPi_actualised = BEGPi/((1+ZC[1:length(BEGPi)])^(1:length(BEGPi)))
BEGP_cede = cumsum(rev(BEGPi_actualised))
BEGP_cede = rev(BEGP_cede)
BEGP_cede = BEGP_cede*taux_cession
Adj_i = Map(\(x,y){
0.5*max(x,0)*PD*(1-PD)^(y-1)
}, x = as.list(BEGP_cede), y = as.list(1:length(BEGP_cede)))
Adj_i = unlist(Adj_i)
Adj_i
BEGPi_actualised = BEGPi/((1+ZC[1:length(BEGPi)])^(1:length(BEGPi)))
BEGP_cede = cumsum(rev(BEGPi_actualised))
BEGP_cede
BEGP_cede = rev(BEGP_cede)
BEGP_cede
BEGP_cede = BEGP_cede*taux_cession
BEGP_cede
BEGPi_actualised = BEGPi/((1+ZC[1:length(BEGPi)])^(1:length(BEGPi)))
BEGP_cede = cumsum(rev(BEGPi_actualised))
BEGP_cede = rev(BEGP_cede)
BEGP_cede
taux_cession
1/100
BEGP_cede*taux_cession
BEGP_cede
Adj_i = Map(\(x,y){
0.5*max(x,0)*PD*(1-PD)^(y-1)
}, x = as.list(BEGP_cede), y = as.list(1:length(BEGP_cede)))
Adj_i = unlist(Adj_i)
Adj_i
Ajustement_DC <- \(BEGPi,ZC,taux_cession,PD){
BEGPi_actualised = BEGPi/((1+ZC[1:length(BEGPi)])^(1:length(BEGPi)))
BEGP_cede = cumsum(rev(BEGPi_actualised))
BEGP_cede = rev(BEGP_cede)
BEGP_cede = BEGP_cede*taux_cession
Adj_i = Map(\(x,y){
0.5*max(x,0)*PD*(1-PD)^(y-1)
}, x = as.list(BEGP_cede), y = as.list(1:length(BEGP_cede)))
Adj_i = unlist(Adj_i)
Adj_act_i = Adj_i/((1+ZC[1:length(Adj_i)])^(1:length(Adj_i)))
sum(Adj_act_i)
}
Ajustement_DC(BEGPi,ZC,0.01,1.2/100)
Adj_i
Adj_act_i = Adj_i/((1+ZC[1:length(Adj_i)])^(1:length(Adj_i)))
Adj_act_i
sum(Adj_act_i)
1.2/100
Ajustement_DC <- \(BEGPi,ZC,taux_cession,PD){
BEGPi_actualised = BEGPi/((1+ZC[1:length(BEGPi)])^(1:length(BEGPi)))
BEGP_cede = cumsum(rev(BEGPi_actualised))
BEGP_cede = rev(BEGP_cede)
BEGP_cede = BEGP_cede*taux_cession
Adj_i = Map(\(x,y){
0.5*max(x,0)*PD*(1-PD)^(y-1)
}, x = as.list(BEGP_cede), y = as.list(1:length(BEGP_cede)))
Adj_i = unlist(Adj_i)
Adj_act_i = Adj_i/((1+ZC[1:length(Adj_i)])^(1:length(Adj_i)))
sum(Adj_act_i)
}
Ajustement_DC(BEGPi,ZC,0.01,0.012)
BEGPi
ZC
Ajustement_DC <- \(BEGPi,ZC,taux_cession,PD){
BEGPi_actualised = BEGPi/((1+ZC[1:length(BEGPi)])^(1:length(BEGPi)))
BEGP_cede = cumsum(rev(BEGPi_actualised))
BEGP_cede = rev(BEGP_cede)
BEGP_cede = BEGP_cede*taux_cession
Adj_i = Map(\(x,y){
0.5*max(x,0)*PD*(1-PD)^(y-1)
}, x = as.list(BEGP_cede), y = as.list(1:length(BEGP_cede)))
Adj_i = unlist(Adj_i)
Adj_act_i = Adj_i/((1+ZC[1:length(Adj_i)])^(1:length(Adj_i)))
sum(Adj_act_i)
}
BEGPi_actualised = BEGPi/((1+ZC[1:length(BEGPi)])^(1:length(BEGPi)))
BEGPi_actualised
BEGP_cede = cumsum(rev(BEGPi_actualised))
BEGP_cede = rev(BEGP_cede)
BEGP_cede = BEGP_cede*taux_cession
Adj_i = Map(\(x,y){
0.5*max(x,0)*PD*(1-PD)^(y-1)
}, x = as.list(BEGP_cede), y = as.list(1:length(BEGP_cede)))
Adj_i = unlist(Adj_i)
Adj_act_i = Adj_i/((1+ZC[1:length(Adj_i)])^(1:length(Adj_i)))
sum(Adj_act_i)
BEGPi_actualised = BEGPi/((1+ZC[1:length(BEGPi)])^(1:length(BEGPi)))
BEGPi_actualised
BEGP_cede = cumsum(rev(BEGPi_actualised))
BEGP_cede = rev(BEGP_cede)
BEGP_cede = BEGP_cede*taux_cession
BEGP_cede
Adj_i = Map(\(x,y){
0.5*max(x,0)*PD*(1-PD)^(y-1)
}, x = as.list(BEGP_cede), y = as.list(1:length(BEGP_cede)))
Adj_i = unlist(Adj_i)
Adj_i
Ajustement_DC <- \(BEGPi,ZC,taux_cession,PD){
BEGPi_actualised = BEGPi/((1+ZC[1:length(BEGPi)])^(1:length(BEGPi)))
BEGP_cede = cumsum(rev(BEGPi_actualised))
BEGP_cede = rev(BEGP_cede)
BEGP_cede = BEGP_cede*taux_cession
Adj_i = Map(\(x,y){
0.5*max(x,0)*PD*(1-PD)^(y-1)
}, x = as.list(BEGP_cede), y = as.list(1:length(BEGP_cede)))
Adj_i = unlist(Adj_i)
Adj_act_i = Adj_i/((1+ZC[1:length(Adj_i)])^(1:length(Adj_i)))
sum(Adj_act_i)
}
BEGP_Choc_002
BEGP_Choc_003
BEFG_vie = BEFG(FG_t,ZC)
BEFG_vie_Choque = BEFG(FG_t_Choque,ZC)
BEFG_vie
BEFG_vie_Choque
cad_liq
r_hat
cad_actualiser
cad_actualiser = cad_liq/((1+ZC[1:length(cad_liq)])^(1:length(cad_liq)))
cad_actualiser
cad_liq
cad_liq0 = cad_liq[-1]
cad_actualiser = cad_liq0/((1+ZC[1:length(cad_liq0)])^(1:length(cad_liq0)))
cad_actualiser
cad_actualiser_cumule = rev(cumsum(rev(cad_actualiser)))
cad_actualiser_cumule
rs
PPNA=25000
RS = rs
PFP_Vect = c(PFP,rep(0,length(cad_liq0)-1))
BEPrimes = RS*(PPNA+PFP_Vect)*cad_actualiser_cumule-PFP_Vect
PFP=100000
PFP_Vect = c(PFP,rep(0,length(cad_liq0)-1))
BEPrimes = RS*(PPNA+PFP_Vect)*cad_actualiser_cumule-PFP_Vect
BEPrimes
PFP
100000
cad
cad_liq
cad_actualiser_cumule
PFP = 90000
cad_liq0 = cad_liq[-1]
cad_actualiser = cad_liq0/((1+ZC[1:length(cad_liq0)])^(1:length(cad_liq0)))
cad_actualiser_cumule = rev(cumsum(rev(cad_actualiser)))
PFP_Vect = c(PFP,rep(0,length(cad_liq0)-1))
BEPrimes = RS*(PPNA+PFP_Vect)*cad_actualiser_cumule-PFP_Vect
BEPrimes
taux_acquistion = 0.4
taux_acquistion = 0.1
cad_liq0 = cad_liq[-1]
cad_actualiser = cad_liq0/((1+ZC[1:length(cad_liq0)])^(1:length(cad_liq0)))
cad_actualiser_cumule = rev(cumsum(rev(cad_actualiser)))
PFP_Vect = c(PFP,rep(0,length(cad_liq0)-1))
PFPA = (1-taux_acquistion)*PFP_Vect
BEPrimes = RS*(PPNA+PFP_Vect)*cad_actualiser_cumule-PFP_Vect
BEPrimes
cad_liq0 = cad_liq[-1]
cad_actualiser = cad_liq0/((1+ZC[1:length(cad_liq0)])^(1:length(cad_liq0)))
cad_actualiser_cumule = rev(cumsum(rev(cad_actualiser)))
PFP_Vect = c(PFP,rep(0,length(cad_liq0)-1))
PFPA = (1-taux_acquistion)*PFP_Vect
BEPrimes = RS*(PPNA+PFP_Vect)*cad_actualiser_cumule-PFPA
BEPrimes
PFPA
taux_acquistion=0.1
cad_liq0 = cad_liq[-1]
cad_actualiser = cad_liq0/((1+ZC[1:length(cad_liq0)])^(1:length(cad_liq0)))
cad_actualiser_cumule = rev(cumsum(rev(cad_actualiser)))
PFP_Vect = c(PFP,rep(0,length(cad_liq0)-1))
PFPA = (1-taux_acquistion)*PFP_Vect
BEPrimes = RS*(PPNA+PFP_Vect)*cad_actualiser_cumule-PFPA
BEPrimes
PFP
PFPA
PFP = 100000
cad_liq0 = cad_liq[-1]
cad_actualiser = cad_liq0/((1+ZC[1:length(cad_liq0)])^(1:length(cad_liq0)))
cad_actualiser_cumule = rev(cumsum(rev(cad_actualiser)))
PFP_Vect = c(PFP,rep(0,length(cad_liq0)-1))
PFPA = (1-taux_acquistion)*PFP_Vect
BEPrimes = RS*(PPNA+PFP_Vect)*cad_actualiser_cumule-PFPA
BEPrimes
# Opeération d'assurance vie
Ajustement_DC_NVie <- \(r_hat,cad_liq,ZC,RS,PPNA,PFP,taux_acquistion){
cad_liq0 = cad_liq[-1]
cad_actualiser = cad_liq0/((1+ZC[1:length(cad_liq0)])^(1:length(cad_liq0)))
cad_actualiser_cumule = rev(cumsum(rev(cad_actualiser)))
PFP_Vect = c(PFP,rep(0,length(cad_liq0)-1))
PFPA = (1-taux_acquistion)*PFP_Vect
BEPrimes = RS*(PPNA+PFP_Vect)*cad_actualiser_cumule-PFPA
}
Ajustement_DC_NVie(r_hat,cad_liq,ZC,RS,PPNA,PFP,taux_acquistion)
# Opeération d'assurance vie
Ajustement_DC_NVie <- \(r_hat,cad_liq,ZC,RS,PPNA,PFP,taux_acquistion){
cad_liq0 = cad_liq[-1]
cad_actualiser = cad_liq0/((1+ZC[1:length(cad_liq0)])^(1:length(cad_liq0)))
cad_actualiser_cumule = rev(cumsum(rev(cad_actualiser)))
PFP_Vect = c(PFP,rep(0,length(cad_liq0)-1))
PFPA = (1-taux_acquistion)*PFP_Vect
BEPrimes = RS*(PPNA+PFP_Vect)*cad_actualiser_cumule-PFPA
BEPrimes
}
Ajustement_DC_NVie(r_hat,cad_liq,ZC,RS,PPNA,PFP,taux_acquistion)
5/100
r_hat
BESinistre = r_hat/((1+ZC[1:length(r_hat)])^(1:length(r_hat)))
BESinistre = rev(cumsum(rev(BESinistre)))
BESinistre
tc_prime = 0.05
tc_sinistre = 0.03
BEPrimes_Cede = tc_prime*BEPrimes
BESinistre = r_hat/((1+ZC[1:length(r_hat)])^(1:length(r_hat)))
BESinistre = rev(cumsum(rev(BESinistre)))
BESinistre_Cede = tc_sinistre*BESinistre
BEPrimes_Cede
BE_ENG_Cede = BESinistre_Cede+BEPrimes_Cede
BE_ENG_Cede
PD
Adj_i = Map(\(x,y){
0.5*max(x,0)*PD*(1-PD)^(y-1)
}, x = as.list(BE_ENG_Cede), y = as.list(1:length(BE_ENG_Cede)))
Adj_i = unlist(Adj_i)
Adj_act_i = Adj_i/((1+ZC[1:length(Adj_i)])^(1:length(Adj_i)))
Adj_act_i
sum(Adj_act_i)
# Opeération d'assurance vie
Ajustement_DC_NVie <- \(r_hat,cad_liq,ZC,RS,PPNA,PFP,taux_acquistion,PD,tc_prime = 0.05 , tc_sinistre = 0.03){
cad_liq0 = cad_liq[-1]
cad_actualiser = cad_liq0/((1+ZC[1:length(cad_liq0)])^(1:length(cad_liq0)))
cad_actualiser_cumule = rev(cumsum(rev(cad_actualiser)))
PFP_Vect = c(PFP,rep(0,length(cad_liq0)-1))
PFPA = (1-taux_acquistion)*PFP_Vect
BEPrimes = RS*(PPNA+PFP_Vect)*cad_actualiser_cumule-PFPA
BEPrimes_Cede = tc_prime*BEPrimes
BESinistre = r_hat/((1+ZC[1:length(r_hat)])^(1:length(r_hat)))
BESinistre = rev(cumsum(rev(BESinistre)))
BESinistre_Cede = tc_sinistre*BESinistre
BE_ENG_Cede = BESinistre_Cede+BEPrimes_Cede
Adj_i = Map(\(x,y){
0.5*max(x,0)*PD*(1-PD)^(y-1)
}, x = as.list(BE_ENG_Cede), y = as.list(1:length(BE_ENG_Cede)))
Adj_i = unlist(Adj_i)
Adj_act_i = Adj_i/((1+ZC[1:length(Adj_i)])^(1:length(Adj_i)))
sum(Adj_act_i)
}
# Opeération d'assurance vie
Ajustement_DC_NVie <- \(r_hat,cad_liq,ZC,RS,PPNA,PFP,taux_acquistion,PD,tc_prime = 0.05 , tc_sinistre = 0.03){
cad_liq0 = cad_liq[-1]
cad_actualiser = cad_liq0/((1+ZC[1:length(cad_liq0)])^(1:length(cad_liq0)))
cad_actualiser_cumule = rev(cumsum(rev(cad_actualiser)))
PFP_Vect = c(PFP,rep(0,length(cad_liq0)-1))
PFPA = (1-taux_acquistion)*PFP_Vect
BEPrimes = RS*(PPNA+PFP_Vect)*cad_actualiser_cumule-PFPA
BEPrimes_Cede = tc_prime*BEPrimes
BESinistre = r_hat/((1+ZC[1:length(r_hat)])^(1:length(r_hat)))
BESinistre = rev(cumsum(rev(BESinistre)))
BESinistre_Cede = tc_sinistre*BESinistre
BE_ENG_Cede = BESinistre_Cede+BEPrimes_Cede
Adj_i = Map(\(x,y){
0.5*max(x,0)*PD*(1-PD)^(y-1)
}, x = as.list(BE_ENG_Cede), y = as.list(1:length(BE_ENG_Cede)))
Adj_i = unlist(Adj_i)
Adj_act_i = Adj_i/((1+ZC[1:length(Adj_i)])^(1:length(Adj_i)))
sum(Adj_act_i)
}
Ajustement_DC_NVie(r_hat,cad_liq,ZC,RS,PPNA,PFP,taux_acquistion,PD,tc_prime = 0.05 , tc_sinistre = 0.03)
shiny::runApp()
runApp()
max(Duree_contrat+Annee)
annees
max(Duree_contrat+annees)
Annee
runApp()
df_capitaux = Matrice_Capitaux(deces_deg_unique$`Année d'effet`,
deces_deg_unique$Dur_e_de_contrat,deces_deg_unique$Capital_d_c_s_initial)
df_capitaux = Matrice_Capitaux(deces_deg_unique$`Année d'effet`,
deces_deg_unique$Dur_e_de_contrat,deces_deg_unique$Capital_d_c_s_initial)
Mat_Proj_Cap <- function(df_capitaux,Duree_contrat_rest,ages,choc = 0){
mat_ages = Mat_Ages(Duree_contrat_rest,ages)
mat_tqx =(1+choc) * Mat_tQx(mat_ages)
mat_tpx = 1 -  mat_tqx
mat_tpx = cbind(1,mat_tpx[,-ncol(mat_tpx)])
mat_tpx_cumul = t(apply(mat_tpx,1,cumprod))
# Matrice de projection des capitaux
mat_tqx*df_capitaux*mat_tpx_cumul
}
proj_cap = Mat_Proj_Cap(df_capitaux,Duree_contrat_rest,ages,choc = 0)
proj_cap_choc_003 = Mat_Proj_Cap(df_capitaux,Duree_contrat_rest,ages,choc = 0.3)
proj_cap_choc_002 = Mat_Proj_Cap(df_capitauxDuree_contrat_rest,ages,choc = 0.2)
ages
# Calculs vie -------
df_capitaux = Matrice_Capitaux(deces_deg_unique$`Année d'effet`,
deces_deg_unique$Dur_e_de_contrat,deces_deg_unique$Capital_d_c_s_initial)
Mat_Proj_Cap <- function(df_capitaux,Duree_contrat_rest,ages,choc = 0){
mat_ages = Mat_Ages(Duree_contrat_rest,ages)
mat_tqx =(1+choc) * Mat_tQx(mat_ages)
mat_tpx = 1 -  mat_tqx
mat_tpx = cbind(1,mat_tpx[,-ncol(mat_tpx)])
mat_tpx_cumul = t(apply(mat_tpx,1,cumprod))
# Matrice de projection des capitaux
mat_tqx*df_capitaux*mat_tpx_cumul
}
proj_cap = Mat_Proj_Cap(df_capitaux,Duree_contrat_rest,ages,choc = 0)
proj_cap_choc_003 = Mat_Proj_Cap(df_capitaux,Duree_contrat_rest,ages,choc = 0.3)
proj_cap_choc_002 = Mat_Proj_Cap(df_capitaux,Duree_contrat_rest,ages,choc = 0.2)
runApp()
runApp()
sum(proj_cap)
runApp()
runApp()
runApp()
runApp()
NB_contrat = NBContrat(ages,Duree_contrat_rest,choc = 0)
NBContrat <- function(ages,Duree_contrat_rest,choc = 0){
mat_ages = Mat_Ages(Duree_contrat_rest,ages)
mat_tqx =(1+choc) * Mat_tQx(mat_ages)
NB_contrat = 1-mat_tqx
NB_contrat = t(apply(NB_contrat,1,cumprod))
max_duree_rest = max(Duree_contrat_rest)
mat_duree = Map(\(x){
c(rep(1,x),rep(0,max_duree_rest-x))
}, x = Duree_contrat_rest)
mat_duree = as.data.frame(mat_duree)
mat_duree = t(mat_duree)
rownames(mat_duree) = NULL
NB_contrat = NB_contrat*mat_duree
NB_contrat = apply(NB_contrat,2,sum)
NB_contrat
}
NB_contrat = NBContrat(ages,Duree_contrat_rest,choc = 0)
NB_contrat
NB_contrat = NBContrat(ages,Duree_contrat_rest,choc = 0.2)
NB_contrat
runApp()
BE_ENG_Cede
runApp()
runApp()
runApp()
runApp()
runApp()
styler:::style_selection()
runApp()
