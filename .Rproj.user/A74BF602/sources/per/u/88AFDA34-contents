import pandas as pd
import requests
from bs4 import BeautifulSoup

url = "https://www.wsj.com/market-data/quotes/index/SPX/historical-prices"
page = requests.get(url)
soup = BeautifulSoup(page.content, 'html.parser')

table = soup.find('table', {'class': 'cr_dataTable'})
headers = [header.text for header in table.find_all('th')]
rows = []
for row in table.find_all('tr'):
    rows.append([val.text for val in row.find_all('td')])

df = pd.DataFrame(rows, columns=headers)
